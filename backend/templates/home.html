{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VoteME</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Bienvenue sur le site de vote</h1>
        <p>Ceci est une page d'accueil simple.</p>
        <p>Découvrez nos catégories de vote et participez aux élections!</p>
        <div id="categories">
            <!-- Les catégories et nominés seront affichés ici -->
        </div>
    </div>

    <script>
        $(document).ready(function(){
            $.get("/api/categories/", function(data){
                let categoriesHTML = '';
                data.forEach(function(category){
                    categoriesHTML += `<h2>${category.name}</h2><ul>`;
                    category.nominees.forEach(function(nominee){
                        categoriesHTML += `
                            <li data-nominee="${nominee}">
                                ${nominee}
                                <button class="vote-btn">Vote</button>
                            </li>`;
                    });
                    categoriesHTML += '</ul>';
                });
                $('#categories').html(categoriesHTML);

                $('.vote-btn').click(function(){
                    const nominee = $(this).parent().data('nominee');                                               $.post("/api/vote/", { nominee: nominee }, function(response){
                        alert('Votre vote a été pris en compte!');
                    });
                });
            });
        });
    </script>
</body>
</html>

